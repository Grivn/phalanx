package external

import commonProto "github.com/Grivn/phalanx-common/types/protos"

// USIG (Unique Sequential Identifier Generator) is a tamper-proof
// component in Phalanx that assigns unique, monotonic, and sequential
// counter to messages and signs it
type USIG interface {
	// CreateUI returns a unique identifier for the specified
	// message. A unique, monotonic, and sequential counter is
	// incremented on each invocation to produce the UI. The first
	// assigned counter value should be one.
	CreateUI(message []byte) (*commonProto.UI, error)

	// VerifyUI verifies if the UI is valid for the message and
	// was generated by the specified USIG identity
	VerifyUI(message []byte, ui *commonProto.UI, usigID []byte) error

	// ID returns the identity of this USIG instance
	ID() []byte
}
